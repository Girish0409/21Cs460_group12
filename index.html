<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <title>Machine Leanrning : Group 12</title>
        <link href="http://www.niser.ac.in/~smishra/css/smlab.css" rel="stylesheet" type="text/css" />
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
        <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js">
        </script>
    </head>

    <body>
        <body style="background-color: rgb(187, 177, 233);">
        <div class="container">
            <h1>Machine Learning CS460 : Group 12</h1>
            <p>Course Instructor : Dr. Subhankar Mishra</p>
            
            <hr />
            <h2>Group Contributers</h2>
            <p>
                Group Repository : <a href="https://github.com/Girish0409/21Cs460_group12">Link</a>
               <ul>
                   <li>Girish Tripathy <br> 
                    1811072, School of Physical Sciences, NISER <br>
                    <a href="https://github.com/girish0409">Github</a>                    
                
                   </li>

                   <li>Shashank Saumya <br> 
                    1811143, School of Physical Sciences, NISER <br>
                    <a href="https://github.com/shashanksaumya123">Github</a>                  
                
                   </li>
               </ul> 
            </p>
            <hr />

            <h1>Title of the project : <br>
                Multiclass classification of White blood cells using Convolutional Neural Network (CNN)<br>
                
            </h1>
            <hr />

            <h3>Biological Background of the project</h3>
            <p>
                WBCs (White Blood cells) also known as leukocytes are the cells of immune system that are involved in protecting the body against both
                infectious invadors and foreign diseases. <br>
                Depending upon the presence of small structures known as granules, WBCs are classified into two different types:
                <ul>
                    <li>Granulocytes: Presence of Granular cytoplasm</li>
                    <li>Agranulocytes: Absence of Granular cytoplasm</li>
                </ul>
                Depending upon the type of nuclus, Granulocytes and Agranulocytes are furthur divided into different types <br>
                <br>
                Granulocytes:
                <ul> 
                    <li>Basophil: About 0.4% in adults. Responsible for allergic and antigen response by releasing a chemical called histamine. Since they are rarest of the EBC and share similarities between other types of cell, they are difficult to study, hence we dont have any data of the same</li>
                    <li>Eosinophil: About 2.3% in adults. Can be distinguished as Bi-lobed nucleus. It rises in responce to allergies, parasitic infections and disease of the spleen and central nervous systems. <br>
                        <centre><img src="eo.png" alt="Eosinophil"></centre>
                    </li>
                    <li>
                        Neutrophil: About 60-70% in adults. Can be distinguished as Multilobed nucleus. Responsible for protection against bacterial or fungal infections.<br> 
                        <centre><img src="nu.png" alt="Neutrophil"></centre> 
                    </li>
                    
                </ul>
                <br>
                Agranulocytes:
                <ul>
                    <li>
                        Monocyte: About 5.3% in adults. Can be distinguished as the largest nucleus. Responsible for phagocytoses of used up neutrophils.<br>
                        <centre><img src="mono.png" alt="Monocyte"></centre>
                    </li>
                    <li>
                        Lymphocyte: ABout 30% in adults. <br>
                        <centre><img src="lym.png" alt="Lymphocyte"></centre>
                    </li>
                </ul>

            </p>

            <h3>
                Motivation and plans :
            </h3>

            <p>
                There is a need to quickly identify blood cells at bulk in the medical field. We propose using a CNN to build a machine which can classify the stained cells to the type of WBCs. The reason we use CNN is because it is known for its high accuracy when it comes to image recognition.
                
            </p>

            <p>
                We plan to first get the RGB info on each pixel of the image. The stained cells are of a different colour from the other cells so it would be easier to identify the pixels which contain the WBC under inspection.
                Then we will use a CNN and train it to get a model which will be able to classify an image containing a stained WBC.
              
            </p>

            <h3>KYD : Know Your Dataset</h3>
            <p>
                               
                The dataset we will using is <a href="https://www.kaggle.com/paultimothymooney/blood-cells">WBC Classification dataset</a> uploaded on Kaggle by Paul Mooney. <br>
                The database consist of about 10,000 images of White blood cells, divided into 4 different classes. Each class have about 2500 RGB images of dimention 320 x 240.  
                
            </p>

            <hr />
            <h3>Midway plans and Work Division :</h3>
            Our Midway plans are follows
            <ul>
                <li>Learn about neural networks from various sources</li>
                <li>Cleaning our data and Preprocessing</li>
                <li>Have a simple CNN model trained and ready to predict</li>
            </ul>
            
            Post midway, we will be exploring methods and layers to make our algorithm and model better in terms of accuracy.

            <br>
            Work Division :
            <ul>
                <li>Refinement and preparing the dataset : Shashank (Image to data squeezing, reshaping), Girish (Finding the Optimal way to work with the data)</li>
                <li>Planning and coding the model :- Girish + Shashank</li>                
                <li>Report Writing, presentation and Website maintainance : Girish</li>
            </ul>

            <hr />

            <h1>Midway Works :</h1> 
            <hr />
            <p>
                Up till now we have done the following:
            </p>
            
            <ul>
                <li>Learnt about the theory behind NN and CNN</li>
                <li>Read the relevant papers</li>
                <li>Done some experimentation of various dataset including ours</li>
            </ul>  
            
            <hr />
             <h2>What is a NN and CNN?</h2>
             <p>
                 <img src="nn.png" alt="Neural Network"> <br>
                 Neural Network (NN) also known as Artificial Neural Network (ANN) as the name suggest is a network of neurons or nodes and forms the basis of Machine Learning and heart of the deep learning algorithms. <br>
                 It mimics a network of biological neurons. All the different neurons or nodes are connected to each other by weights giving a layer liked structure. A positive weight corresponds to excitory connection and a negative weight corresponds to inhibitory connections. <br>
                 This weights can be found out or calculated during the traning of the machine learning model. <br>
                 The first layer of a NN is known as input layer, the last layer is known as output layer. The layers in between both, is known as hidden layer. Number of hidden layers is decided considering the dataset and complexity of the model. <br>
                 Backpropagation is an important algorithm by which a neural network learns from its own mistakes. <br>
                 <br>
                 There are various types of Neural networks like Artificial neural network (ANN), Convolutional Neural Network (CNN), Recurrent Neural Network (RNN), Long short term memory neural network (LSTM) etc. 
                 Each type of Neural network have its own uses. <br> 
                 <br>
                 Neural Network that is frequently used for image classification is Convolutional Neural network (CNN). CNN is a type of NN with another hidden layer known as "convolution layer". <br>
                 A convolution layer have multiple filters, each filter tried to find a particular pattern. Lets say we are trying to classify an image into birds. A convolution layer will have multiple filters, like a beak filter which detect pattern in beaks of the bird, or a eye filter which detects eye of a bird. These filters or nodes will activate nodes of another convolution layer which might have a head filter or a body filter. When all the required filters or nodes get activated, the output layer will gives us the type of bird we are trying to classify bases on the input of the hidden layers.<br>
                 <img src="filter.png" alt="Filters"> <br>
                 <br>

                 We will be using Sequencial method from Keras API in tensorflow library to build our model. We will also be using other functions and method for preprocessing of the image and furthur tweaking of the model 

                 

                
             </p>

             <hr />
             <h2>Some Analysis of the papers</h2>
             <ul>
                 <li>Important points and analysis on Paper 1: WBC Classification using CNN, Mayank sharma, Aishwarya Bhave and Rekh Ram Jaghel
                    <ul>
                        <li>Use the same WBC data (with some augmentation and downsizing)</li>
                        <li>Use a 7 layered (LeNet) CNN model</li>
                        <li>Tried for different epochs and Learning rates</li>
                        <li>Best results at 20 epochs and 0.001 Learning rate (0.8793 Accuracy)</li>
                    </ul>
                 </li>
                    
                 <li>
                    Important points and analysis on Paper 2: Counting and Classification of WBC using ANN, Shubham Manik, lalit Mohan Saini and Nikhil Vadera
                    <ul>
                        <li>They have the image of a slide which contains multiple WBCs</li>
                        <li>Used Image Segmentation Techniques likes Cell and Nucleus Segmentation</li>
                        <li>Morphological features are extracted like, Cell area, nucleus area, area ratio, number of lobules in nucleus, etc</li>
                        <li>Use NN to perform multiclass Classification</li>
                        <li>However, they only had 90 leukocyte (WBC) samples which is very small data</li>
                        <li>The accuracy was around 98.9%</li>
                    </ul>
                     
                 </li>
             </ul>

            <hr />

            <h3>Various experiments we have done. <a href="https://github.com/Girish0409/21cs460_group12/tree/main/Code%20and%20Data">Link </a>to the codes</h3>
            <ul>
                <li>Mnist database : NN Single layered : Adam Optimiser : Sigmoid Activation : 92.80 % testing accuracy</li>
                <li>Mnist database : NN Multi-layered : Adam Optimiser : Sigmoid Activation : 98.04 % testing accuracy </li>
                <li>Cifar10 database : NN Multilayered : SGD Optimiser : Sigmoid Activation : 55.33 % testing accuracy</li>
                <li>Cifar10 database : NN Multilayered : Adam Optimiser : Softmax Activation : 48 % testing accuracy</li>
                <li>Cifar10 database : NN Multilayered : SGD Optimiser : one hot encoding + softmax activation : 56% testing accuracy</li>
                <li>Cifar10 database : CNN Multilayered (2 Convolution layers) : Adam optimiser : Softmax Activation : Accuracy Training = 93 %, Testing = 68%</li>
                <li>WBC database : CNN multilayered (2 Convolution Layers) : Adam optimiser : Softmax activation : Accuracy training = 100 %, testing = 48%</li>

            </ul>
            <hr />

            <h3>Future ideas and comments on the current experiments</h3>
            <ul>
                <li>Understand LeNet and if possible come up with a better model/layer combination</li>
                <li>Our CNN model is getting overfitted on the databases. This maybe due lack of data augmentation. To tackle that, we are thinking to do the following
                    <ul>
                        <li>Use data augmentation, resizing etc.</li>
                        <li>Use image segmentation method to separate the nucleus from the image, and train the model on that</li>
                        <li>Use GridSearchCV for tuning of hyperparameters</li>
                    </ul>
                </li>
            </ul>

            <hr />
            <h1>Final Works</h1>
            <p>
                Till now we are able to do the following:
                <ul>
                    <li>Generated data from image augmentation, but could not train our model on the same due to Out of memory errors.</li>
                    <li>Did image segmentation techniques to extract the nucleus from the image</li>
                    <li>Tried out regularisation techniques to tackle overfitting</li>
                    <li>Tried out Keras Tuner for hyperparameters</li>
                </ul>
            </p>
            <hr />
            <h2>Experimentals and different models : <a href="https://github.com/Girish0409/21cs460_group12/tree/main/Code%20and%20Data/Post%20Midway"> Link </a> to the codes </h2>
            <ul>
                <li>Model 1 (Base - old model) : Multilayers CNN : Adam optimiser : one hot encoding : Train acc = 99.97 % : Testing acc = 27.51% -> This model is getting overfitted</li>
                <li>Model 2 (Model 1 + Image segmentation) : Multilayered CNN : Training acc = 98% : Testing acc = 70 -> Better performance can be seen</li>
                <li>Model 3 (Model 2 + Dropout Regularisation) : Multilayered CNN : Training acc = 83% : Testing acc = 74% -> Regulation did made our model better </li>
                <li>Model 4 (Using better image segmentation, image segmentation minus stray patches) : Multilayered CNN : Training acc = 98.74% : Testing acc = 72%</li>
                <li>Model 5 (Image segmentation plus Dropout layer) : Multilayered CNN : Training Acc = 89.67% : Testing acc = 77.94% -> Best Model Till now</li>
            </ul>
            <hr />
            <h3>Problems so far and possible fixes</h3>
            <ul>
                <li>No augmentation, can be solved by doing batchwise training of model on the augmented images</li>
                <li>Not clear image even after image segmentation, image needs to be cropped</li>
                <li>Model getting confused in Class 1 (Eosinophil) and class 4 (Nutrophil). Maybe due to similar structure of nucleus</li>
            </ul>
            <hr />
            
            <h2>Relevant Paper and Sources:</h2>
            <ul>
                <li>Sharma M., Bhave A., Janghel R.R. (2019) White Blood Cell Classification Using Convolutional Neural Network. In: Wang J., Reddy G., Prasad V., Reddy V. (eds) Soft Computing and Signal Processing. Advances in Intelligent Systems and Computing, vol 900. Springer, Singapore. https://doi.org/10.1007/978-981-13-3600-3_13. <a href="https://link.springer.com/chapter/10.1007/978-981-13-3600-3_13"> Link</a></li>
                <li>S. Manik, L. M. Saini and N. Vadera, "Counting and classification of white blood cell using Artificial Neural Network (ANN)," 2016 IEEE 1st International Conference on Power Electronics, Intelligent Control and Energy Systems (ICPEICES), 2016, pp. 1-5, doi: 10.1109/ICPEICES.2016.7853644. <a href="https://ieeexplore.ieee.org/abstract/document/7853644"> Link</a></li>
                <li>Image recognition using convolutional neural network combined with ensemble learning algorithm, Weilong Mo et al 2019 J. Phys.: Conf. Ser. 1237 022026 <a href="https://www.researchgate.net/publication/334426609_Image_recognition_using_convolutional_neural_network_combined_with_ensemble_learning_algorithm">Link</a></li>
                <li>Q. Li, W. Cai, X. Wang, Y. Zhou, D. D. Feng and M. Chen, "Medical image classification with convolutional neural network," 2014 13th International Conference on Control Automation Robotics & Vision (ICARCV), 2014, pp. 844-848, doi: 10.1109/ICARCV.2014.7064414. <a href="https://ieeexplore.ieee.org/document/7064414">Link</a></li>
                <li>Jiaohua Qin, Wenyan Pan, Xuyu Xiang, Yun Tan, Guimin Hou, A biological image classification method based on improved CNN, Ecological Informatics, Volume 58, 2020, 101093, ISSN 1574-9541, https://doi.org/10.1016/j.ecoinf.2020.101093. <a href="https://www.sciencedirect.com/science/article/abs/pii/S1574954120300431">Link</a></li>
            </ul>

        </div>
    </body>
    

</html>
